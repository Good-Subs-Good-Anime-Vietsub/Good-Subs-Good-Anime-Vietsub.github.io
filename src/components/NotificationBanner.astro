---
import { getCollection } from 'astro:content';
import { Icon } from 'astro-icon/components';

// Lấy thông báo có slug là 'homepage'
const notifications = await getCollection('notifications', ({ id }) => id === 'homepage.md');
const notification = notifications[0];

let shouldRender = false;
if (notification) {
  const { enabled, expires } = notification.data;
  const isExpired = expires ? new Date(expires) < new Date() : false;
  if (enabled && !isExpired) {
    shouldRender = true;
  }
}

const { Content } = notification ? await notification.render() : { Content: null };
---

{shouldRender && Content && (
  <div class="group relative bg-cyan-600/10 text-cyan-300 p-4 rounded-lg border border-cyan-500/30 mb-8 text-center">
    <div class="flex items-center justify-center gap-4">
      <Icon name="mdi:sparkles" class="w-7 h-7 flex-shrink-0 text-yellow-400 transition-transform duration-300 group-hover:scale-110" />
      <div class="prose prose-invert max-w-none text-xs md:text-base prose-p:m-0 prose-a:text-cyan-400 prose-a:font-semibold hover:prose-a:text-cyan-300 prose-strong:text-white prose-a:no-underline">
        <Content />
      </div>
      <Icon name="mdi:sparkles" class="w-7 h-7 flex-shrink-0 text-yellow-400 transition-transform duration-300 group-hover:scale-110" />
    </div>
  </div>
)}